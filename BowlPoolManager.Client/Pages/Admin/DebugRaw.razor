@page "/admin/debug-raw"
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject HttpClient Http

<h3>Debug Raw CFBD JSON</h3>

<div class="mb-3">
    <button class="btn btn-outline-primary me-2" @onclick='() => LoadRaw("games")'>Fetch /games (2025)</button>
    <button class="btn btn-outline-danger" @onclick='() => LoadRaw("scoreboard")'>Fetch /scoreboard (Live)</button>
</div>

@if (IsLoading)
{
    <p>Loading...</p>
}
else
{
    <div class="bg-light p-3 border rounded">
        <pre style="max-height: 600px; overflow-y: auto; white-space: pre-wrap;">@RawJson</pre>
    </div>
}

@code {
    private string RawJson = "Click a button to fetch data.";
    private bool IsLoading = false;

    private async Task LoadRaw(string source)
    {
        IsLoading = true;
        RawJson = "Fetching...";
        try
        {
            var url = source == "scoreboard" 
                ? "api/GetRawCfbdGames?source=scoreboard" 
                : "api/GetRawCfbdGames";
                
            RawJson = await Http.GetStringAsync(url);
        }
        catch (Exception ex)
        {
            RawJson = $"Error: {ex.Message}";
        }
        finally
        {
            IsLoading = false;
        }
    }
}
